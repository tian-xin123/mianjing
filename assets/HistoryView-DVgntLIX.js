import{K as _,L as H,M as O,N as P,a as p,O as L,P as N,d as S,r as g,m as A,c as u,b as C,e as l,F as I,D as M,Q as $,t as w,u as V,o as d,R as E,l as f,i as F,_ as R}from"./index-Bs1UhSfa.js";let h;const U={title:"",width:"",theme:null,message:"",overlay:!0,callback:null,teleport:"body",className:"",allowHtml:!1,lockScroll:!0,transition:void 0,beforeClose:null,overlayClass:"",overlayStyle:void 0,messageAlign:"",cancelButtonText:"",cancelButtonColor:null,cancelButtonDisabled:!1,confirmButtonText:"",confirmButtonColor:null,confirmButtonDisabled:!1,showConfirmButton:!0,showCancelButton:!1,closeOnPopstate:!0,closeOnClickOverlay:!1,destroyOnClose:!1};let W=_({},U);function z(){({instance:h}=O({setup(){const{state:s,toggle:e}=P();return()=>p(N,L(s,{"onUpdate:show":e}),null)}}))}function K(r){return H?new Promise((s,e)=>{h||z(),h.open(_({},W,r,{callback:n=>{(n==="confirm"?s:e)(n)}}))}):Promise.resolve(void 0)}const k=r=>K(_({showCancelButton:!0},r)),Q={class:"history-container"},j={key:0,class:"empty-state"},q={key:1,class:"history-list"},G=["onClick"],J={class:"item-content"},X={class:"item-title"},Y={class:"item-meta"},Z={class:"item-time"},tt=S({__name:"HistoryView",setup(r){const s=V(),e=g([]),n=g(!0),B=a=>{const o=new Date(a),i=new Date().getTime()-o.getTime(),t=Math.floor(i/(1e3*60*60*24));if(t===0){const c=Math.floor(i/36e5);if(c===0){const y=Math.floor(i/6e4);return y<=1?"刚刚":`${y}分钟前`}return`${c}小时前`}else return t===1?"昨天":t<7?`${t}天前`:o.toLocaleDateString("zh-CN")},m=()=>{e.value=$(),n.value=e.value.length===0},b=a=>{s.push(`/article/${a}`)},x=(a,o)=>{o.stopPropagation(),k({title:"确认删除",message:"确定要删除这条浏览记录吗？"}).then(()=>{E(a),m(),f("删除成功")}).catch(()=>{})},D=()=>{if(e.value.length===0){f("没有可清空的记录");return}k({title:"确认清空",message:"确定要清空所有浏览记录吗？此操作不可恢复。"}).then(()=>{F(),m(),f("清空成功")}).catch(()=>{})},T=()=>{s.back()};return A(()=>{m()}),(a,o)=>{const v=C("van-nav-bar"),i=C("van-icon");return d(),u("div",Q,[p(v,{title:"浏览记录","left-text":"返回","left-arrow":"",onClickLeft:T,"right-text":n.value?"":"清空",onClickRight:D},null,8,["right-text"]),n.value?(d(),u("div",j,[...o[0]||(o[0]=[l("p",{class:"empty-text"},"暂无浏览记录",-1),l("p",{class:"empty-tip"},"浏览文章后会自动记录在这里",-1)])])):(d(),u("div",q,[(d(!0),u(I,null,M(e.value,t=>(d(),u("div",{key:t.id,class:"history-item",onClick:c=>b(t.id)},[l("div",J,[l("h3",X,w(t.title),1),l("div",Y,[l("span",Z,"查看于 "+w(B(t.viewedAt)),1)])]),p(i,{name:"cross",class:"delete-icon",onClick:c=>x(t.id,c)},null,8,["onClick"])],8,G))),128))]))])}}}),ot=R(tt,[["__scopeId","data-v-b6620fe0"]]);export{ot as default};
